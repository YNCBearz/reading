# **邊界剖析 (Boundary Anatomy)**

## **跨越邊界 (Boundary Crossing)**
### 跨越邊界即在邊界的一邊呼叫另一邊的函式並傳遞資料。
>  建立適當的跨越邊界技巧就是在**管理原始碼的依賴關係**。

<br>

## **可怕的單片 (The Dreaded Monolith)**
### 最簡單和最常見的架構邊界沒有嚴格實際的表示。
### 可能只是在一個可執行檔 (以下稱作單片) 中，按照規範進行函式與資料結構的分離。
> 這樣的架構總是依賴**某種動態多型**來管理內部依賴關係。

<br>

```

        ────────────────     ||        ─────────────────
       |     Client     | ----------> |     Service     |
        ────────────────     ||        ─────────────────
                |            ||                |
                |            ||                V
                |            ||        ────────────<DS>─
                -------------||-----> |       Data      |
                             ||        ─────────────────
```
<center>圖 18.1 控制流從較低層級跨越邊界到較高層級</center>

<br><br>

```

        ────────────────            ─────────────<I>─       ||       ─────────────────
       |     Client     | -------> |     Service     | ◁---------- |   Service Impl   |
        ────────────────            ─────────────────       ||       ─────────────────
                |                                           ||               |
                |                                           ||               |
                V                                           ||               |
        ────────────<DS>─                                   ||               |
       |      Data       | <--------------------------------------------------
        ─────────────────                                   ||
```
<center>圖 18.2 跨越邊界的方向與控制流的方向是相反的</center>

<br>

> 跨越邊界的方式：**函示呼叫**。

<br>

## **部屬元件 (Deployment Components)**
> 跨越邊界的方式：**動態鏈結後，函示呼叫**。

<br>

## **執行緒 (Threads)**
### 單片和部屬元件都可以使用執行緒。
### 執行緒不是架構邊界或部屬單元，而是一種組織排程和執行順序的方式。

<br>

## **本地行程 (Local Processes)**
### 一個更強大的實體架構邊界是本地行程，通常透過命令列或等效系統呼叫來建立。
### 可視作超級元件：該行程由較低層級的元件所組成，透過動態多型來管理它們的依賴關係。
### 原始碼依賴關係指向跨越邊界的相同方向，並始終指向更高層級的元件。
### 無謂通訊的代價非常昂貴，應該小心謹慎。
### **請記住，架構的目標是要讓低層級的行程成為更高層級行程的plugin。**

> 跨越邊界的方式：**系統呼叫**。

<br>

## **服務 (Services)**
### 最強的邊界是服務。
### 無謂通訊的代價非常昂貴，應該小心謹慎。這個層級的通訊必須處理高層級的延遲。
### 高層級服務的原始碼不可包含任何較低層級的具體實體知識。

> 跨越邊界的方式：**透過網路呼叫**。

<br>

## **總結 (Conclusion)**
### 除了單片之外，大多數系統都使用複數邊界策略。
### 系統中的邊界往往混合「本地經常通訊的邊界」和「更關注於延遲的邊界」。
