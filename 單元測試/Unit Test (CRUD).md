# **Unit Test (CRUD)**

由於單元測試，不與外部 (包括檔案、資料庫、網路、服務、物件、類別) 直接相依。

接下來介紹，模擬外部相依物件常見的三個名詞：**Stub**, **Mock**, **Fake**

## **虛設常式 (Stub)**
>## *Def.*
> A stub is a controllable replacement for an existing dependency
(or collaborator) in the system.

#### 在測試程式中，透過虛設常式來避免必須直接相依物件所造成的問題。

## 使用時機：
> 1. 驗證目標物件的回傳值

```js
                           I.呼叫方法
        ─────────────────  -------->  ─────────────────  II.模擬互動  ─────────────────
        |    測試程式    |            |     目標物件    |  <--------> |     相依物件    |
        ─────────────────  <--------  ─────────────────              ─────────────────
                           III.驗證回傳
```

> 2. 驗證目標物件的狀態改變

```js
                           I.呼叫方法
        ─────────────────  -------->  ─────────────────  II.模擬互動  ─────────────────
        |    測試程式    |            |     目標物件    |  <--------> |     相依物件    |
        ─────────────────  -------->  ─────────────────              ─────────────────
                           III.驗證狀態
```

## **模擬物件 (Mock)**
>## *Def.*
> A mock object is a fake object in the system that decides whether
the unit test has passed or failed.

## 使用時機：
> 3. 驗證目標物件與外部相依介面的互動方式

```js

        ───────────────── I.呼叫方法   ─────────────────  II.模擬互動  ─────────────────
        |    測試程式    | -------->  |     目標物件    |  <--------> |     相依物件    |
        ─────────────────             ─────────────────              ─────────────────
                :                                             ^
                :                III.驗證互動                  :
                 ---------------------------------------------
```

#### 虛設常式與模擬物件相當類似，但你會對模擬物件進行驗證，而不會對虛設常式作驗證。
#### 辨別兩者的方法：虛設常式不會導致測試失敗，而模擬物件可以。
#### 一個測試中，只會存在一個模擬物件。


## **假物件 (Fake)**
>## *Def.*
> A fake is a generic term that can be used to describe either a stub
or a mock object (handwritten or otherwise), because they both look like the
real object.

#### 判斷假物件究竟是虛設常式或模擬物件，取決於它於測試中使用的方式。
#### 而絕大部分的情況下，你會使用的是虛設常式，而非模擬物件。
